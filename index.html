<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SOFT-ATA TECNOLOGIA EM SOFTWARES - CENTRAL</title>

  <!--
    ✔ Mantido: CSS/JS externos
    ✔ Observação: o script usa "defer" para garantir que o DOM esteja parseado
  -->
  <link rel="stylesheet" href="style.css" />
  <script src="script.js" defer></script>
</head>
<body>
  <!-- ================================================================
       HEADER — topo fixo
       Ajuste: avatar de perfil foi movido PARA DENTRO do header (à direita),
       conforme pedido (ficar ao lado do relógio/tema).
       ================================================================ -->
  <header>
    <div class="wrap">
      <div class="row" style="justify-content:space-between;align-items:center">
        <!-- Lado esquerdo: botão hambúrguer + título -->
        <div class="row">
          <button class="hamb" id="btnHamb" title="Menu" aria-label="Abrir menu lateral">
            <span class="bars" aria-hidden="true"></span>
          </button>
          <h1 style="margin-left:8px">SOFT-ATA TECNOLOGIA EM SOFTWARES</h1>
        </div>

        <!-- Lado direito: relógio + switch de tema + avatar de perfil -->
        <!-- Dica: este bloco tem margin-left:auto via .theme-toggle, empurrando-o para a direita -->
        <div class="theme-toggle" title="Alternar claro/escuro">
          <span id="clock" class="clock" aria-live="polite">00:00:00</span>
          <span class="chip">Tema</span>
          <button class="switch" id="themeSwitch" aria-label="Alternar tema">
            <span class="knob"></span>
          </button>

          <!-- Perfil (avatar clicável) — NOVO: movido do body para o header -->
          <div class="profile-box">
            <button id="btnProfile" class="profile-btn" aria-label="Abrir perfil">
              <img id="profileAvatar" class="avatar" src="" alt="Foto do perfil" />
              <div class="profile-meta">
                <div id="profileName" class="profile-name">Seu nome</div>
                <div id="profileSector" class="profile-sector">Setor</div>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- ================================================================
       SIDEBAR — navegação por abas
       Acessibilidade: adicionados IDs nos botões (role=tab) e
       painéis referenciando esses IDs via aria-labelledby.
       ================================================================ -->
  <!-- GRUPO COLAPSÁVEL: Contatos -->
       <nav class="sidebar" id="sidebar" aria-label="Navegação principal">
    <h2>Painel</h2>
    <div class="nav" id="navList" role="tablist" aria-orientation="vertical">
      <button id="tabbtn-home"      data-go="home"      role="tab" aria-controls="tab-home"      aria-selected="false">Home</button>
      <button id="tabbtn-fila"      data-go="fila"      role="tab" aria-controls="tab-fila"      aria-selected="false">Atendimento</button>
      <button id="tabbtn-ordens"    data-go="ordens"    role="tab" aria-controls="tab-ordens"    aria-selected="false">Ordens</button>
      <button id="tabbtn-clientes"  data-go="clientes"  role="tab" aria-controls="tab-clientes"  aria-selected="false">Cadastros</button>
      <button id="tabbtn-dashboard" data-go="dashboard" role="tab" aria-controls="tab-dashboard" aria-selected="false">Dashboard</button>
      <button id="tabbtn-util"      data-go="util"      role="tab" aria-controls="tab-util"      aria-selected="false">Utilitários</button>
      <button id="tabbtn-manuais"   data-go="manuais"   role="tab" aria-controls="tab-manuais"   aria-selected="false">Manuais</button>
      <button id="tabbtn-ideias"    data-go="ideias"    role="tab" aria-controls="tab-ideias"    aria-selected="false">Ideias & Melhorias</button>
      <button id="tabbtn-atualiz"   data-go="atualiz"   role="tab" aria-controls="tab-atualiz"   aria-selected="false">Atualizações</button>
      <button id="tabbtn-holerite"  data-go="holerite"  role="tab" aria-controls="tab-holerite"  aria-selected="false">Holerite</button>
      <!-- SUBSTITUIR no navList -->
      <button id="tabbtn-assistente" data-go="assistente" role="tab" aria-controls="tab-assistente" aria-selected="false">Assistente</button>
      <button id="tabbtn-config"    data-go="config"    role="tab" aria-controls="tab-config"    aria-selected="false">Configurações</button>
    </div>
  </nav>

  <!-- ================================================================
       MAIN — painéis (um por aba)
       Ajuste: deixamos SOMENTE a HOME visível inicialmente; os demais com hidden.
       O JS controla visibilidade via setTab().
       ================================================================ -->
  <main>
    <!-- ============================ HOME ============================= -->
    <section id="tab-home" class="panel" role="tabpanel" aria-labelledby="tabbtn-home">
      <h2>Painel de Ordens</h2>
      <div class="dash-cards" id="homeCards"></div>

      <hr class="sep" />

      <h2>Calendário</h2>
      <div class="cal" id="cal">
        <!-- Cabeçalho do calendário -->
        <div class="cal-head">
          <button class="btn primary" id="calPrev" aria-label="Mês anterior">◀</button>
          <div class="title" id="calTitle" aria-live="polite"></div>
          <button class="btn primary" id="calNext" aria-label="Próximo mês">▶</button>

          <!-- Ferramentas de evento rápidas -->
          <div class="right row">
            <div class="row" style="gap:8px">
              <input id="ev_title" placeholder="Título do evento" aria-label="Título do evento">
              <input id="ev_date" type="date" aria-label="Data do evento">
              <input id="ev_time" type="time" aria-label="Hora do evento">
              <select id="ev_recur" aria-label="Recorrência">
                <option value="none">Sem recorrência</option>
                <option value="daily">Diária</option>
                <option value="weekly">Semanal</option>
                <option value="monthly">Mensal</option>
              </select>
              <select id="ev_count" title="Contagem do prazo" aria-label="Contagem do prazo">
                <option value="corridos">Dias corridos</option>
                <option value="uteis">Dias úteis</option>
              </select>
              <button class="btn success" id="ev_add">Adicionar</button>
            </div>
          </div>
        </div>

        <!-- Linha com nomes dos dias da semana -->
        <div class="cal-grid" id="calDow" aria-hidden="true">
          <div class="cal-dow">Dom</div><div class="cal-dow">Seg</div><div class="cal-dow">Ter</div>
          <div class="cal-dow">Qua</div><div class="cal-dow">Qui</div><div class="cal-dow">Sex</div><div class="cal-dow">Sáb</div>
        </div>

        <!-- Grade de dias (gerada via JS em #calGrid) -->
        <div class="cal-grid" id="calGrid" aria-live="polite"></div>

        <!-- Lista de compromissos do dia selecionado -->
        <div class="cal-list panel" id="calList">
          <h4>Compromissos de <span id="calListDate"></span></h4>
          <div id="calListItems" class="grid" style="gap:8px"></div>
        </div>
      </div>
    </section>

    <!-- ========================== CLIENTES ========================== -->
    <section id="tab-clientes" class="panel" role="tabpanel" aria-labelledby="tabbtn-clientes" hidden>
      <h3>Clientes</h3>
      <div class="grid cols-4">
        <input id="c_nome" placeholder="Nome do cliente" />
        <input id="c_codigo" placeholder="Código interno" />
        <input id="c_tel" placeholder="Telefone (com DDD)" />
        <input id="c_resp" placeholder="Responsável" />
      </div>
      <div class="row" style="margin-top:8px">
        <button class="btn success" id="c_add">Adicionar cliente</button>
      </div>
      <hr class="sep" />
      <table class="table">
        <thead>
          <tr><th>Código</th><th>Cliente</th><th>Telefone</th><th>Responsável</th><th></th></tr>
        </thead>
        <tbody id="tblClientes"></tbody>
      </table>
    </section>

    <!-- ======================== ATENDIMENTO ========================= -->
<section id="tab-fila" class="panel" role="tabpanel" aria-labelledby="tabbtn-fila" hidden>
  <h3>Atendimento</h3>

  <!-- (1+2) Cliente, Solicitante e demais campos -->
<div class="grid cols-6" style="gap:12px; margin-top:10px">
  <div>
    <label for="t_cliente">Cliente (obrigatório)</label>
    <select id="t_cliente" required aria-required="true">
      <option value="">Selecione um cliente…</option>
    </select>
  </div>
  <div>
    <label>Cliente selecionado</label>
    <div id="t_cliente_info" class="chip" aria-live="polite">Nenhum cliente selecionado</div>
  </div>
  <div>
    <label for="t_solicitante">Solicitante</label>
    <input id="t_solicitante" placeholder="Nome do solicitante">
  </div>
  <div>
    <label for="t_modulo">Módulo</label>
    <select id="t_modulo" aria-label="Módulo">
      <option value="">Módulo</option>
    </select>
  </div>
  <div>
    <label for="t_motivo">Motivo</label>
    <select id="t_motivo" aria-label="Motivo">
      <option value="">Motivo</option>
    </select>
  </div>
  <div>
    <label for="t_data">Data</label>
    <input id="t_data" type="date" title="Data do atendimento" aria-label="Data do atendimento">
  </div>
</div>

  <!-- (3) Ações do formulário -->
  <div class="row" style="margin-top:10px">
    <button class="btn success" id="t_add">Adicionar</button>
  </div>

  <!-- (4) Quadro Kanban -->
  <!-- Cards devem exibir: "Código do cliente e Nome / Módulo / Motivo / Data / (botões de status abaixo)".
       O JS vai montar os cards dinamicamente e ocultar o botão do status atual.
       Quando o status for "Concluído", o botão "Aberto" vira "Reabrir" ao lado do "Editar". -->
  <div class="kanban" style="margin-top:12px">
    <div class="col" data-col="aberto">
      <h4>Aberto</h4>
      <div class="tlist" id="col-aberto"></div>
    </div>
    <div class="col" data-col="atendimento">
      <h4>Em atendimento</h4>
      <div class="tlist" id="col-atendimento"></div>
    </div>
    <div class="col" data-col="aguardando">
      <h4>Aguardando retorno</h4>
      <div class="tlist" id="col-aguardando"></div>
    </div>
    <div class="col" data-col="programacao">
      <h4>Programação</h4>
      <div class="tlist" id="col-programacao"></div>
    </div>
    <div class="col" data-col="concluido">
      <h4>Concluído</h4>
      <div class="tlist" id="col-concluido"></div>
    </div>
  </div>
</section>

<!-- ===== Templates de Atendimento (usados pelo JS) ===== -->

<!-- Template do CARD de atendimento (estrutura padrão que o JS vai clonar) -->
<template id="ticketCardTpl">
  <div class="ticket" data-id="">
    <!-- Cabeçalho do card -->
    <div class="head">
      <!-- Título do card: "COD — Nome do Cliente" -->
      <div class="title" data-bind="clienteTitulo">COD — Nome</div>
      <!-- Pill com o status atual -->
      
    </div>

    <!-- Metadados principais -->
<div class="meta">
  <div class="meta-line"><b>Módulo:</b> <span data-bind="modulo">—</span></div>
  <div class="meta-line"><b>Motivo:</b> <span data-bind="motivo">—</span></div>
  <div class="meta-line"><b>Data:</b>   <span data-bind="data">—</span></div>
  <div class="meta-line"><b>Solicitante:</b> <span data-bind="solicitante">—</span></div>
</div>

<!-- Usuário -->
<div class="assignee row" style="margin-top:8px">
  <img class="avatar" data-bind="assigneeAvatar" alt="Foto do usuário">
  <span class="assignee-name" data-bind="assigneeName">Sem usuário</span>
</div>

    <!-- Problema / Solução -->
    <div class="ps grid cols-2" style="gap:8px">
      <div>
        <label class="muted">Problema</label>
        <div class="ps-text" data-bind="problem">—</div>
      </div>
      <div>
        <label class="muted">Solução</label>
        <div class="ps-text" data-bind="solution">—</div>
      </div>
    </div>

    <!-- Área dos botões de status (o JS vai ocultar o botão do status atual) -->
    <div class="actions" data-bind="actions">
      <!-- Os botões serão inseridos via JS respeitando as cores:
           Aberto (Azul), Aguardando (Amarelo), Em atendimento (Laranja),
           Programação (Roxo), Concluído (Verde) -->
    </div>
  </div>
</template>

<!-- ========== TELINHA (POPOVER) DO ATENDIMENTO ========== -->
<template id="ticketActionsTpl">
  <div class="popover" role="dialog" aria-modal="true" aria-label="Ações do atendimento">
    <button class="popover__close" data-close aria-label="Fechar" type="button">✖</button>

    <div class="popover__content">
      <h4 style="margin:0 0 6px">Atendimento</h4>

      <!-- Campo de Solicitante (novo) -->
      <div class="grid cols-1" style="gap:8px; margin:8px 0">
        <div>
          <label class="muted" for="po_solicitante">Solicitante</label>
          <input id="po_solicitante" placeholder="Quem solicitou o atendimento?">
        </div>
      </div>

      <!-- Problema / Solução dentro da telinha (já existia) -->
      <div class="grid cols-2" style="gap:8px">
        <div>
          <label class="muted" for="po_problem">Problema</label>
          <textarea id="po_problem" rows="5" placeholder="Descreva o problema"></textarea>
        </div>
        <div>
          <label class="muted" for="po_solution">Solução</label>
          <textarea id="po_solution" rows="5" placeholder="Descreva a solução"></textarea>
        </div>
      </div>

      <div class="row" style="justify-content:flex-end;gap:8px;margin-top:10px">
        <button class="btn success editar" data-act="edit"   type="button">Editar</button>
        <button class="btn danger  excluir" data-act="delete" type="button">Excluir</button>
        <button class="btn success"         data-act="save"   type="button">Salvar</button>
        <button class="btn lancar pink" data-act="launch" data-visible-for="concluido" type="button">Lançar</button>
      </div>
    </div>
  </div>
</template>

<!-- Container fixo onde a telinha será renderizada -->
<div id="popoverRoot" class="popover-root" hidden></div>

    <!-- ========================== ORDENS ============================ -->
    <!-- Ajuste: deixamos hidden para evitar "piscar" antes do JS esconder -->
    <section id="tab-ordens" class="panel" role="tabpanel" aria-labelledby="tabbtn-ordens" hidden>
      <h3>Ordens</h3>
      <table class="table">
        <thead>
          <tr><th>#</th><th>Título</th><th>Status</th><th>Previsto</th><th></th></tr>
        </thead>
        <tbody id="tblOrdens">
          <!-- Linha semente de exemplo (o JS pode limpar e repopular) -->
          <tr data-id="seed-001">
            <td>001</td>
            <td>Exemplo</td>
            <td><span class="pill open">Aberto</span></td>
            <td>—</td>
            <td>
              <div class="row">
                <button class="btn sm programacao" data-act="programacao">Programação</button>
                <button class="btn sm excluir" data-act="del">Excluir</button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <!-- ======================== DASHBOARD =========================== -->
    <section id="tab-dashboard" class="panel" role="tabpanel" aria-labelledby="tabbtn-dashboard" hidden>
      <h3>Dashboard</h3>
      <div class="kpis" id="kpis"></div>
      <hr class="sep" />
      <div id="feed" class="grid"></div>
    </section>

    <!-- ======================= ASSISTENTE ======================= -->
<section id="tab-assistente" class="panel assist-wrap" role="tabpanel" aria-labelledby="tabbtn-assistente" hidden>
  <div class="v-assistente">
    <!-- Cabeçalho -->
    <section class="assist-hero">
      <div>
        <h2>Assistente de Cálculos Trabalhistas</h2>
        <p class="muted">Folha, Férias, 13º, Horas Extras, Adicional Noturno, Rescisão, Parâmetros e Totais.</p>
      </div>
      <div class="chips">
        <span class="chip badge">SOFT‑ATA</span>
        <span class="chip">Set/2025</span>
        <span class="chip">v2.0</span>
      </div>
    </section>

    <!-- Abas -->
    <nav class="assist-tabs" role="tablist" aria-label="Assistente de Cálculos">
      <button class="assist-tab active" data-tab="folha" role="tab" aria-selected="true">🧾 Folha</button>
      <button class="assist-tab" data-tab="ferias" role="tab">🌴 Férias</button>
      <button class="assist-tab" data-tab="decimo" role="tab">🎁 13º</button>
      <button class="assist-tab" data-tab="horas" role="tab">⏱️ Horas Extras</button>
      <button class="assist-tab" data-tab="noturno" role="tab">🌙 Adic. Noturno</button>
      <button class="assist-tab" data-tab="rescisao" role="tab">📄 Rescisão</button>
      <button class="assist-tab" data-tab="tabelas" role="tab">⚙️ Parâmetros</button>
      <button class="assist-tab" data-tab="resumo" role="tab">📊 Totais</button>
    </nav>

    <div class="assist-grid">
      <!-- Coluna principal: formulários -->
      <div class="assist-col">
        <!-- Folha -->
        <section id="pane-folha" class="assist-pane" role="tabpanel">
          <div class="panel">
            <h3 class="panel-title">Cálculo da Folha Mensal (CLT)</h3>
            <p class="muted">INSS progressivo, FGTS 8%, IRRF (tabelas jan–abr/25 e desde mai/25), dependentes, desconto simplificado e salário‑família.</p>
            
            <div class="form-grid">
              <div>
                <label for="f-salario">Remuneração base (R$)</label>
                <input id="f-salario" class="input" type="number" min="0" step="0.01" placeholder="Ex.: 3500,00">
              </div>
              <div>
                <label for="f-dependentes">Dependentes (IRRF)</label>
                <input id="f-dependentes" class="input" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label for="f-competencia">Competência</label>
                <select id="f-competencia" class="input">
                  <option value="2025-09" selected>Set/2025 (pós-maio)</option>
                  <option value="2025-04">Abr/2025 (jan–abr)</option>
                </select>
              </div>
              <div>
                <label for="f-simplificado">Desconto simplificado IRRF</label>
                <select id="f-simplificado" class="input">
                  <option value="nao" selected>Não (tradicional)</option>
                  <option value="sim">Sim (25% até teto)</option>
                </select>
              </div>
              <div>
                <label for="f-outras">Outras verbas (R$)</label>
                <input id="f-outras" class="input" type="number" min="0" step="0.01" value="0">
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcularFolha" class="btn primary">Calcular</button>
              <button id="btnLimparFolha" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- Férias -->
        <section id="pane-ferias" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">Férias (1/3 constitucional)</h3>
            <p class="muted">Com opção de abono (venda) de até 10 dias e cálculo de IRRF/INSS.</p>
            
            <div class="form-grid">
              <div>
                <label for="fer-salario">Remuneração base (R$)</label>
                <input id="fer-salario" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="fer-dias">Dias de férias</label>
                <input id="fer-dias" class="input" type="number" min="0" max="30" value="30">
              </div>
              <div>
                <label for="fer-abono">Abono (dias vendidos)</label>
                <select id="fer-abono" class="input">
                  <option value="0" selected>Não</option>
                  <option value="10">10 dias</option>
                </select>
              </div>
              <div>
                <label for="fer-dependentes">Dependentes (IRRF)</label>
                <input id="fer-dependentes" class="input" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label for="fer-competencia">Competência IRRF</label>
                <select id="fer-competencia" class="input">
                  <option value="maio-2025" selected>Mai/2025 em diante</option>
                  <option value="jan-abr-2025">Jan–Abr/2025</option>
                </select>
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcularFerias" class="btn primary">Calcular</button>
              <button id="btnLimparFerias" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- 13º -->
        <section id="pane-decimo" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">13º Salário</h3>
            <p class="muted">Cálculo proporcional por meses no ano, com INSS e IRRF na 2ª parcela.</p>
            
            <div class="form-grid">
              <div>
                <label for="d-salario">Salário base (R$)</label>
                <input id="d-salario" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="d-meses">Meses trabalhados</label>
                <input id="d-meses" class="input" type="number" min="0" max="12" value="12">
              </div>
              <div>
                <label for="d-dependentes">Dependentes (IRRF)</label>
                <input id="d-dependentes" class="input" type="number" min="0" step="1" value="0">
              </div>
              <div>
                <label for="d-adiant">Adiantamento</label>
                <select id="d-adiant" class="input">
                  <option value="0">Não</option>
                  <option value="1" selected>Sim (50%)</option>
                </select>
              </div>
              <div>
                <label for="d-competencia">Competência IRRF (2ª parcela)</label>
                <select id="d-competencia" class="input">
                  <option value="maio-2025" selected>Mai/2025 em diante</option>
                  <option value="jan-abr-2025">Jan–Abr/2025</option>
                </select>
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcular13" class="btn primary">Calcular</button>
              <button id="btnLimpar13" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- Horas Extras -->
        <section id="pane-horas" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">Horas Extras</h3>
            <p class="muted">Cálculo pelo valor hora (220h/mês) com percentuais de 50%, 70% ou 100%.</p>
            
            <div class="form-grid">
              <div>
                <label for="h-salario">Salário mensal (R$)</label>
                <input id="h-salario" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="h-horas">Horas extras (mês)</label>
                <input id="h-horas" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="h-adic">Adicional</label>
                <select id="h-adic" class="input">
                  <option value="0.5" selected>50% (dias úteis)</option>
                  <option value="1.0">100% (dom./fer.)</option>
                  <option value="0.7">70%</option>
                </select>
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcularHoras" class="btn primary">Calcular</button>
              <button id="btnLimparHoras" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- Adicional Noturno -->
        <section id="pane-noturno" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">Adicional Noturno</h3>
            <p class="muted">Urbano 20% com hora ficta (52m30s) • Rural 25% (sem hora ficta).</p>
            
            <div class="form-grid">
              <div>
                <label for="n-salario">Salário mensal (R$)</label>
                <input id="n-salario" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="n-horas">Horas noturnas</label>
                <input id="n-horas" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="n-perc">Percentual</label>
                <select id="n-perc" class="input">
                  <option value="0.20" selected>20% (urbano)</option>
                  <option value="0.25">25% (rural)</option>
                </select>
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcularNoturno" class="btn primary">Calcular</button>
              <button id="btnLimparNoturno" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- Rescisão -->
        <section id="pane-rescisao" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">Rescisão (sem justa causa)</h3>
            
            <div class="form-grid">
              <div>
                <label for="r-salario">Salário base (R$)</label>
                <input id="r-salario" class="input" type="number" min="0" step="0.01">
              </div>
              <div>
                <label for="r-meses">Meses trabalhados no ano</label>
                <input id="r-meses" class="input" type="number" min="0" max="12" value="12">
              </div>
              <div>
                <label for="r-saldo-dias">Saldo de dias (mês)</label>
                <input id="r-saldo-dias" class="input" type="number" min="0" max="30" value="0">
              </div>
              <div>
                <label for="r-fgts-saldo">Saldo FGTS (histórico) R$</label>
                <input id="r-fgts-saldo" class="input" type="number" min="0" step="0.01" placeholder="Para multa de 40%">
              </div>
              <div>
                <label for="r-ferias-vencidas">Férias vencidas?</label>
                <select id="r-ferias-vencidas" class="input">
                  <option value="nao" selected>Não</option>
                  <option value="sim">Sim (30 dias + 1/3)</option>
                </select>
              </div>
              <div>
                <label for="r-motivo">Motivo</label>
                <select id="r-motivo" class="input">
                  <option value="sem-justa" selected>Sem justa causa</option>
                  <option value="pedido">Pedido de demissão</option>
                  <option value="termino">Término de contrato (prazo)</option>
                  <option value="justa">Justa causa</option>
                </select>
              </div>
              <div>
                <label for="r-aviso">Aviso prévio</label>
                <select id="r-aviso" class="input">
                  <option value="indenizado" selected>Indenizado</option>
                  <option value="trabalhado">Trabalhado</option>
                  <option value="dispensado">Dispensado</option>
                </select>
              </div>
              <div>
                <label for="r-aviso-dias">Dias de aviso</label>
                <input id="r-aviso-dias" class="input" type="number" min="0" max="90" value="30">
              </div>
            </div>
            
            <div class="action-buttons">
              <button id="btnCalcularRescisao" class="btn primary">Calcular</button>
              <button id="btnLimparRescisao" class="btn ghost">Limpar</button>
            </div>
          </div>
        </section>

        <!-- Parâmetros -->
        <section id="pane-tabelas" class="assist-pane" role="tabpanel" hidden>
          <div class="panel">
            <h3 class="panel-title">Parâmetros oficiais — 2025</h3>
            <p class="muted">Alterações podem ocorrer por lei/portaria/CCT. Edite no código-fonte (objeto <code>PARAMS</code>) se necessário.</p>
            
            <div class="grid cols-2">
              <div class="panel">
                <h4>INSS (empregado) — desde 01/01/2025</h4>
                <ul class="muted" style="padding-left: 20px; margin-top: 10px;">
                  <li>Até R$ 1.518,00 → 7,5%</li>
                  <li>R$ 1.518,01 a R$ 2.793,88 → 9%</li>
                  <li>R$ 2.793,89 a R$ 4.190,83 → 12%</li>
                  <li>R$ 4.190,84 a R$ 8.157,41 → 14%</li>
                </ul>
                <p class="muted" style="margin-top: 10px; font-size: 12px;">Teto: R$ 8.157,41 • Salário‑mínimo: R$ 1.518,00</p>
              </div>
              <div class="panel">
                <h4>IRRF mensal — desde 05/2025</h4>
                <ul class="muted" style="padding-left: 20px; margin-top: 10px;">
                  <li>Até R$ 2.428,80 → isento</li>
                  <li>R$ 2.428,81 a R$ 2.826,65 → 7,5% (deduz R$ 182,16)</li>
                  <li>R$ 2.826,66 a R$ 3.751,05 → 15% (deduz R$ 394,16)</li>
                  <li>R$ 3.751,06 a R$ 4.664,68 → 22,5% (deduz R$ 675,49)</li>
                  <li>Acima de R$ 4.664,68 → 27,5% (deduz R$ 908,73)</li>
                </ul>
                <p class="muted" style="margin-top: 10px; font-size: 12px;">Dependente: R$ 189,59 • Simplificado: 25% até R$ 607,20/mês</p>
              </div>
              <div class="panel">
                <h4>FGTS</h4>
                <p class="muted" style="margin-top: 10px;">Depósito mensal: 8% (regra geral). Multa rescisória: 40% do saldo em demissão sem justa causa.</p>
              </div>
              <div class="panel">
                <h4>Salário‑família — desde 01/01/2025</h4>
                <p class="muted" style="margin-top: 10px;">R$ 65,00 por dependente até a remuneração de R$ 1.906,04.</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Totais -->
        <section id="pane-resumo" class="assist-pane" role="tabpanel" hidden>
          <div class="grid cols-2">
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>Folha</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-folha" type="checkbox" checked> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Líquido</span><span id="sum-folha-liq">—</span></div>
                <div class="kv"><span class="muted">Descontos</span><span id="sum-folha-desc">—</span></div>
                <div class="kv"><span class="muted">Proventos</span><span id="sum-folha-prov">—</span></div>
                <div class="kv"><span class="muted">FGTS (8%)</span><span id="sum-folha-fgts">—</span></div>
              </div>
            </div>
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>Férias</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-ferias" type="checkbox"> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Líquido</span><span id="sum-ferias-liq">—</span></div>
              </div>
            </div>
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>13º</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-decimo" type="checkbox"> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Líquido</span><span id="sum-decimo-liq">—</span></div>
              </div>
            </div>
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>Horas Extras</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-horas" type="checkbox" checked> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Total</span><span id="sum-horas">—</span></div>
              </div>
            </div>
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>Adic. Noturno</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-noturno" type="checkbox" checked> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Total</span><span id="sum-noturno">—</span></div>
              </div>
            </div>
            <div class="panel">
              <div class="row" style="justify-content: space-between; margin-bottom: 10px;">
                <h4>Rescisão</h4>
                <label class="text-sm flex items-center gap-2">
                  <input id="include-rescisao" type="checkbox"> Incluir
                </label>
              </div>
              <div class="space-y-2">
                <div class="kv"><span class="muted">Líquido</span><span id="sum-rescisao-liq">—</span></div>
                <div class="kv"><span class="muted">Multa FGTS 40%</span><span id="sum-rescisao-multa">—</span></div>
              </div>
            </div>
          </div>
          
          <div class="panel" style="margin-top: 20px;">
            <div class="row" style="justify-content: space-between; align-items: center;">
              <div>
                <h3 class="panel-title">Total geral líquido</h3>
                <p class="muted">Soma dos módulos selecionados acima.</p>
              </div>
              <div id="sum-total" style="font-size: 28px; font-weight: 800; color: var(--accent);">—</div>
            </div>
          </div>
        </section>
      </div>

      <!-- Coluna lateral: resultados (sticky) -->
      <aside class="assist-col">
        <div class="sticky-box">
          <div class="panel">
            <h3 class="panel-title">Resultados</h3>

            <div id="result-folha" class="result-box space-y-2">
              <h4>Folha</h4>
              <div class="kv"><span class="muted">Base INSS</span><span id="r-base-inss">—</span></div>
              <div class="kv"><span class="muted">INSS</span><span id="r-inss">—</span></div>
              <div class="kv"><span class="muted">Base FGTS</span><span id="r-base-fgts">—</span></div>
              <div class="kv"><span class="muted">FGTS (8%)</span><span id="r-fgts">—</span></div>
              <div class="kv"><span class="muted">Base IRRF</span><span id="r-base-irrf">—</span></div>
              <div class="kv"><span class="muted">IRRF</span><span id="r-irrf">—</span></div>
              <div class="kv"><span class="muted">Salário‑família</span><span id="r-salario-familia">—</span></div>
              <hr class="sep"/>
              <div class="kv"><span class="muted">Descontos</span><span id="r-descontos">—</span></div>
              <div class="kv"><span class="muted">Proventos</span><span id="r-proventos">—</span></div>
              <div class="kv big"><span class="muted">Líquido</span><span id="r-liquido">—</span></div>
            </div>

            <div id="result-ferias" class="result-box space-y-2" hidden>
              <h4>Férias</h4>
              <div class="kv"><span class="muted">Valor férias</span><span id="r-ferias-valor">—</span></div>
              <div class="kv"><span class="muted">1/3 constitucional</span><span id="r-ferias-terco">—</span></div>
              <div class="kv"><span class="muted">Abono pecuniário</span><span id="r-ferias-abono">—</span></div>
              <div class="kv"><span class="muted">INSS</span><span id="r-ferias-inss">—</span></div>
              <div class="kv"><span class="muted">IRRF</span><span id="r-ferias-irrf">—</span></div>
              <hr class="sep"/>
              <div class="kv big"><span class="muted">Líquido</span><span id="r-ferias-liquido">—</span></div>
            </div>

            <div id="result-decimo" class="result-box space-y-2" hidden>
              <h4>13º Salário</h4>
              <div class="kv"><span class="muted">Valor bruto</span><span id="r-decimo-bruto">—</span></div>
              <div class="kv"><span class="muted">Adiantamento (50%)</span><span id="r-decimo-adiant">—</span></div>
              <div class="kv"><span class="muted">INSS</span><span id="r-decimo-inss">—</span></div>
              <div class="kv"><span class="muted">IRRF</span><span id="r-decimo-irrf">—</span></div>
              <hr class="sep"/>
              <div class="kv big"><span class="muted">Líquido (2ª parcela)</span><span id="r-decimo-liquido">—</span></div>
            </div>

            <div id="result-horas" class="result-box space-y-2" hidden>
              <h4>Horas Extras</h4>
              <div class="kv"><span class="muted">Valor hora</span><span id="r-horas-valor">—</span></div>
              <div class="kv"><span class="muted">Adicional (%)</span><span id="r-horas-adicional">—</span></div>
              <div class="kv"><span class="muted">Total horas extras</span><span id="r-horas-total">—</span></div>
            </div>

            <div id="result-noturno" class="result-box space-y-2" hidden>
              <h4>Adicional Noturno</h4>
              <div class="kv"><span class="muted">Valor hora</span><span id="r-noturno-valor">—</span></div>
              <div class="kv"><span class="muted">Adicional (%)</span><span id="r-noturno-adicional">—</span></div>
              <div class="kv"><span class="muted">Total adicional</span><span id="r-noturno-total">—</span></div>
            </div>

            <div id="result-rescisao" class="result-box space-y-2" hidden>
              <h4>Rescisão</h4>
              <div class="kv"><span class="muted">Saldo salário</span><span id="r-rescisao-saldo">—</span></div>
              <div class="kv"><span class="muted">13º proporcional</span><span id="r-rescisao-decimo">—</span></div>
              <div class="kv"><span class="muted">Férias proporcionais</span><span id="r-rescisao-ferias">—</span></div>
              <div class="kv"><span class="muted">1/3 férias</span><span id="r-rescisao-terco">—</span></div>
              <div class="kv"><span class="muted">Aviso prévio</span><span id="r-rescisao-aviso">—</span></div>
              <div class="kv"><span class="muted">Multa FGTS 40%</span><span id="r-rescisao-multa">—</span></div>
              <div class="kv"><span class="muted">INSS</span><span id="r-rescisao-inss">—</span></div>
              <div class="kv"><span class="muted">IRRF</span><span id="r-rescisao-irrf">—</span></div>
              <hr class="sep"/>
              <div class="kv big"><span class="muted">Líquido</span><span id="r-rescisao-liquido">—</span></div>
            </div>
          </div>
        </div>
      </aside>
    </div>

    <footer>
      <p>Assistente de Cálculos Trabalhistas — ADM SOFT‑ATA • Set/2025 • v2.0</p>
      <p>Desenvolvido para fins educacionais e de apoio à gestão de pessoal.</p>
    </footer>
  </div>
</section>

    <!-- ======================== UTILITÁRIOS ========================== -->
    <section id="tab-util" class="panel" role="tabpanel" aria-labelledby="tabbtn-util" hidden>
      <h3>Utilitários</h3>
      <div class="util-grid">
        <div class="card">
          <b>Gerar link WhatsApp</b>
          <div class="grid cols-3">
            <input id="u_tel" placeholder="Telefone (com DDD)">
            <input id="u_msg" placeholder="Mensagem (opcional)">
            <button class="btn cyan" id="u_go">Gerar</button>
          </div>
          <div id="u_out" class="chips" style="margin-top:8px"></div>
        </div>

        <div class="card">
          <b>Conversor de data/hora</b>
          <div class="grid cols-3">
            <input id="u_dt" type="datetime-local">
            <select id="u_locale">
              <option value="pt-BR">pt-BR</option>
              <option value="en-US">en-US</option>
            </select>
            <button class="btn primary" id="u_fmt">Formatar</button>
          </div>
          <div id="u_dt_out" class="chips" style="margin-top:8px"></div>
        </div>
      </div>
    </section>

    <!-- ======================== CONFIGURAÇÕES ======================== -->
    <section id="tab-config" class="panel" role="tabpanel" aria-labelledby="tabbtn-config" hidden>
      <h3>Configurações</h3>

      <div class="card" aria-labelledby="cfg-modulos-motivos">
        <b id="cfg-modulos-motivos">Módulos e Motivos de Atendimento</b>
        <div class="grid cols-2" style="gap:12px">
          <div>
            <label for="cfg_modulos">Módulos (um por linha)</label>
            <textarea id="cfg_modulos" rows="8" placeholder="Fiscal&#10;Contábil&#10;Folha"></textarea>
          </div>
          <div>
            <label for="cfg_motivos">Motivos (um por linha)</label>
            <textarea id="cfg_motivos" rows="8" placeholder="Erro no sistema&#10;Dúvida do usuário&#10;Ajuste de cadastro"></textarea>
          </div>
        </div>
        <div class="row" style="margin-top:10px;gap:8px">
          <button class="btn success" id="cfg_save_modmot">Salvar</button>
        </div>
      </div>

      <div class="card" style="margin-top:12px" aria-labelledby="cfg-prazo">
        <b id="cfg-prazo">Prazo/Atraso</b>
        <div class="row">
          <label><input type="checkbox" id="cfg_overdue"> Destacar atrasados</label>
          <button class="btn success" id="cfg_save">Salvar</button>
        </div>
      </div>

      <div class="card" style="margin-top:12px" aria-labelledby="cfg-status">
        <b id="cfg-status">Status (somente leitura)</b>
        <div class="chips" id="cfg_status"></div>
      </div>
    </section>

    <!-- ======================= PLACEHOLDERS ========================== -->
    <section id="tab-manuais" class="panel" role="tabpanel" aria-labelledby="tabbtn-manuais" hidden>
      <h3>Manuais</h3>
      <p class="muted">Conteúdo a definir.</p>
    </section>

    <section id="tab-ideias" class="panel" role="tabpanel" aria-labelledby="tabbtn-ideias" hidden>
      <h3>Ideias & Melhorias</h3>
      <p class="muted">Conteúdo a definir.</p>
    </section>

    <section id="tab-atualiz" class="panel" role="tabpanel" aria-labelledby="tabbtn-atualiz" hidden>
      <h3>Atualizações</h3>
      <p class="muted">Conteúdo a definir.</p>
    </section>

    <section id="tab-holerite" class="panel" role="tabpanel" aria-labelledby="tabbtn-holerite" hidden>
      <h3>Holerite</h3>
      <p class="muted">Conteúdo a definir.</p>
    </section>

    <!-- ============================= MODAIS ========================== -->

    <!-- MODAL: Editar atendimento -->
    <div id="editModal" class="modal" hidden aria-hidden="true" aria-labelledby="editModalTitle" role="dialog">
      <div class="modal__backdrop" data-close aria-label="Fechar"></div>
      <div class="modal__card">
        <h3 id="editModalTitle">Editar atendimento</h3>
        <p class="muted" style="margin-top:-6px">Altere os campos abaixo e salve.</p>

        <input type="hidden" id="e_ticket_id">

        <div class="grid cols-2" style="margin-top:10px; gap:10px">
          <div>
            <label for="e_titulo">Título</label>
            <input id="e_titulo" placeholder="Título do chamado">
          </div>
          <div>
            <label for="e_modulo">Módulo</label>
            <select id="e_modulo"></select>
          </div>
          <div>
            <label for="e_motivo">Motivo</label>
            <select id="e_motivo"></select>
          </div>
          <div>
            <label for="e_data">Data</label>
            <input id="e_data" type="date">
          </div>
        </div>

        <div class="row" style="justify-content:flex-end; gap:8px; margin-top:12px">
          <button class="btn accent" id="e_cancel">Cancelar</button>
          <button class="btn success" id="e_save">Salvar alterações</button>
        </div>
      </div>
    </div>

    <!-- MODAL: Detalhes do atendimento (Problema/Solução) -->
    <div id="ticketModal" class="modal" hidden aria-hidden="true" aria-labelledby="ticketModalTitle" role="dialog">
      <div class="modal__backdrop" data-close aria-label="Fechar"></div>
      <div class="modal__card">
        <div class="row" style="justify-content:space-between;align-items:center">
          <h3 id="ticketModalTitle">Detalhes do atendimento</h3>
          <button class="btn ghost" data-close style="padding:4px 10px;font-size:14px" aria-label="Fechar">✖</button>
        </div>
        <p class="muted" style="margin-top:-6px">Revise as informações, descreva o problema e a solução.</p>

        <input type="hidden" id="tm_id">

        <!-- Bloco 1: campos básicos -->
        <div id="tm_block_basic" class="grid cols-2" style="margin-top:10px; gap:10px" data-ro="1">
          <div>
            <label for="tm_titulo">Título</label>
            <input id="tm_titulo" placeholder="Título do chamado">
          </div>
          <div>
            <label for="tm_modulo">Módulo</label>
            <select id="tm_modulo"></select>
          </div>
          <div>
            <label for="tm_motivo">Motivo</label>
            <select id="tm_motivo"></select>
          </div>
          <div>
            <label for="tm_data">Data</label>
            <input id="tm_data" type="date">
          </div>
        </div>

        <!-- Bloco 2: Problema/Solução -->
        <div id="tm_block_ps" class="grid cols-2" style="margin-top:10px; gap:10px" data-ro="1">
          <div>
            <label for="tm_problem">Problema</label>
            <textarea id="tm_problem" rows="6" placeholder="Descreva o problema encontrado"></textarea>
          </div>
          <div>
            <label for="tm_solution">Solução</label>
            <textarea id="tm_solution" rows="6" placeholder="Descreva a solução aplicada"></textarea>
          </div>
        </div>

        <div class="modal__actions">
          <button class="btn blue" id="tm_edit">Editar</button>
          <button class="btn concluido" id="tm_save">Salvar</button>
          <button class="btn excluir" id="tm_del">Excluir</button>
        </div>
      </div>
    </div>

    <!-- MODAL: Lançar ordem a partir do atendimento -->
    <div id="launchModal" class="modal" hidden aria-hidden="true" aria-labelledby="launchModalTitle" role="dialog">
      <div class="modal__backdrop" data-close aria-label="Fechar"></div>
      <div class="modal__card">
        <h3 id="launchModalTitle">Lançar Ordem</h3>
        <p class="muted" style="margin-top:-6px">Preencha Problema e Solução para lançar a ordem.</p>

        <input type="hidden" id="m_ticket_id">

        <div class="grid cols-2" style="margin-top:10px; gap:10px">
          <div>
            <label for="m_problem">Problema</label>
            <textarea id="m_problem" rows="6" placeholder="Descreva o problema"></textarea>
          </div>
          <div>
            <label for="m_solution">Solução</label>
            <textarea id="m_solution" rows="6" placeholder="Descreva a solução aplicada"></textarea>
          </div>
        </div>

        <div class="row" style="justify-content:flex-end; gap:8px; margin-top:12px">
          <button class="btn accent" id="m_cancel">Cancelar</button>
          <button class="btn success" id="m_save">Lançar</button>
        </div>
      </div>
    </div>

<!-- CORRIJA o fechamento do modal de perfil (linhas finais do arquivo) -->
<div id="profileModal" class="modal" hidden aria-hidden="true"
     aria-labelledby="profileModalTitle" role="dialog">
  <div class="modal__backdrop" data-close aria-label="Fechar"></div>

  <div class="modal__card">
    <div class="row" style="justify-content:space-between;align-items:center">
      <h3 id="profileModalTitle">Perfil</h3>
      <button class="btn ghost" id="profileModalClose" style="padding:4px 10px;font-size:14px" aria-label="Fechar">✖</button>
    </div>
    <p class="muted" style="margin-top:-6px">Adicione sua foto e dados básicos.</p>

    <div class="grid cols-2" style="margin-top:10px; gap:12px">
      <!-- Foto -->
      <div>
        <label for="pf_foto">Foto de perfil</label>
        <input id="pf_foto" type="file" accept="image/*">
        <div class="row" style="margin-top:8px">
          <img id="pf_preview" class="avatar lg" src="" alt="Pré-visualização da foto">
        </div>
      </div>

      <!-- Dados -->
      <div class="grid cols-2" style="gap:10px">
        <div style="grid-column:1 / -1">
          <label for="pf_nome">Nome completo</label>
          <input id="pf_nome" placeholder="Digite seu nome completo">
        </div>
        <div>
          <label for="pf_nasc">Data de nascimento</label>
          <input id="pf_nasc" type="date">
        </div>
        <div>
          <label for="pf_setor">Setor</label>
          <input id="pf_setor" placeholder="Ex.: Suporte, Fiscal, Comercial">
        </div>

        <div style="grid-column:1 / -1"><hr class="sep"></div>

        <div>
          <label for="pf_tel_setor">Telefone do setor</label>
          <input id="pf_tel_setor" placeholder="(00) 0000-0000">
        </div>
        <div>
          <label for="pf_email_corp">E-mail corporativo</label>
          <input id="pf_email_corp" type="email" placeholder="voce@empresa.com.br">
        </div>
        <div>
          <label for="pf_ramal">Ramal</label>
          <input id="pf_ramal" placeholder="000">
        </div>
      </div>
    </div>
    <div class="modal__actions">
      <button class="btn success" id="pf_save">Salvar</button>
    </div>
    </div> <!-- /.modal__card -->
  </div> <!-- /#profileModal -->
  </main>
</body>
</html>
